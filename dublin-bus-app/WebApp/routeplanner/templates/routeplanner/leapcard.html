<div class="content p-0 col">
   
    <div class="row sidebar-header">
        Leap Card
    </div>
    <div class="row px-3 sidebar-content">
        <div class="col">
            <form method="post" id="formadd">
                <b>Leap card account information:</b></br></br>
                {% csrf_token %}
                <table>
                    {{ form.as_table}}
                </table>
                
                <button type="submit" class="btn btn-primary float-right" style="margin-right:2%;margin-top:8%">Submit</button>

            </form>
        </div>
    </div>
    <div class="text-center">
        <div class="spinner-grow text-warning m-5" role="status" id="leap-info-loader">
            <span class=" sr-only">Loading...</span>
        </div>
    </div>
    <div id="leap-info">
        <!-- <h2 id="leap-info">Card:</h2> 
        <h4>{{ result.card }}</h4> -->
        <!-- <h2 id="leap-info">Balance: </h2> 
        <h4>{{ result.balance }}</h4> -->
    </div>
</div>


<!-- <script src="https://cdn.static.runoob.com/libs/jquery/1.10.2/jquery.min.js"></script>   -->
<script>  
    $(document).ready(function(){  
        $.ajaxSetup({  
            data: {csrfmiddlewaretoken: '{{ csrf_token }}' },  
        });

        $("#leap-info-loader").hide();

    // enact this function after form submission
    $('#formadd').submit(function(){  

        $("#leap-info-loader").show();

        //info is getting username and password values by their id
        info={      
                username:$('#un').val(),   
                password:$('#pw').val(),
                };

            $.ajax({  
                type:"POST",  
                cache: false,  
                dataType: "html",  
                headers:{'Content-Type':"application/json"},
                data: info,
                url: "/leapinfo", //url to handle variables
                success: function(result, statues, xml){  
                    // if success, return the result back to html with id "#leap-info"
                    $("#leap-info").html(renderLeapcardInfo($('#un').val(),result));   
                    $("#leap-info-loader").hide(); 
                },  
                error: function(){  
                    //otherwise alert false
                    alert("false");  
                    $("#leap-info-loader").hide();
                }  
            });  
            return false;  
        }); 
    });

    function renderLeapcardInfo(username, balance){
        content = '<div style="margin: 10px 20px;"';
        content += `<p>Hi <b>${username}</b>,</p>`;
        content += `<p>your leapcard balance is ‎<b>€${balance}</b></p></div>`;
        return content
    }

</script> 